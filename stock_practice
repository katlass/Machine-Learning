import pandas as pd
import numpy as np
import re
wd="C:\\Users\\sshirol\\Documents\\dow_jones_index\\"

#read in data file
data=pd.read_csv(wd+"dow_jones_index.data",sep=',')

#shows summary info
def InitialDisplay(df):
    print(df.head())
    print(df.info())
InitialDisplay(data)

#removes specified bad letters
def CharacterRemover(df,column,removal_list=['$']):
    reg = '|'.join(removal_list)
    df[column]=df[column].str.replace(reg, '', regex=True)
    return df[column]
    
def DataCleaner(df):
    #flag non numeric columns
    non_numbers=df.select_dtypes(exclude=[np.number]).columns.values
    print(non_numbers)
    new_df=np.array(list(map(lambda x: CharacterRemover(df,non_numbers[x]),range(len(non_numbers)))))
    print(new_df)
DataCleaner(data)

#Helper Functions
#returns Null rows
def NullRows(df,res=False):
    df=df[df.isnull().any(axis=1)].head()
    if len(df)>0:res=df
    return(res)

#check for null values, returns columns where they are or False
def NULLChecker(df,res=False):
    df=df.replace(r'^\s*$', np.nan, regex=True)
    res1=df.isnull().values.any()
    if res1 == True:
        res=df.columns[df.isna().any()].tolist()
        print(res)   
        print(NullRows(data))
NULLChecker(data)

https://archive.ics.uci.edu/ml/datasets/Dow+Jones+Index
